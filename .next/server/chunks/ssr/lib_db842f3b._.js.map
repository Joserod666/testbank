{"version":3,"sources":["../../../../lib/server-init.ts"],"sourcesContent":["/**\r\n * Este archivo se ejecuta al iniciar el servidor\r\n * Inicializa el verificador de deadlines\r\n * \r\n * IMPORTANTE: Solo se ejecuta en runtime del servidor, no durante el build\r\n */\r\n\r\nlet deadlineCheckerStarted = false\r\n\r\nexport async function initializeServer() {\r\n\t// Evitar ejecución durante el build\r\n\tif (process.env.NEXT_PHASE === \"phase-production-build\") {\r\n\t\treturn\r\n\t}\r\n\r\n\tif (deadlineCheckerStarted) {\r\n\t\treturn\r\n\t}\r\n\r\n\t// Solo ejecutar en el servidor, no en el cliente\r\n\tif (typeof window === \"undefined\") {\r\n\t\ttry {\r\n\t\t\t// Usar setTimeout para asegurar que se ejecute después del build\r\n\t\t\tsetTimeout(async () => {\r\n\t\t\t\tconst { startDeadlineChecker } = await import(\"@/lib/cron/deadline-checker\")\r\n\r\n\t\t\t\t// Ejecutar verificaciones cada hora (60 minutos)\r\n\t\t\t\t// En desarrollo, puedes cambiar esto a un intervalo más corto para pruebas\r\n\t\t\t\tconst intervalMinutes = process.env.NODE_ENV === \"production\" ? 60 : 30\r\n\r\n\t\t\t\tstartDeadlineChecker(intervalMinutes)\r\n\t\t\t\tdeadlineCheckerStarted = true\r\n\r\n\t\t\t\tconsole.log(\"✅ Servidor inicializado - Verificador de deadlines activo\")\r\n\t\t\t}, 1000)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error al inicializar verificador de deadlines:\", error)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Ejecutar al cargar el módulo (solo en servidor, después del build)\r\nif (typeof window === \"undefined\" && process.env.NEXT_PHASE !== \"phase-production-build\") {\r\n\t// Usar process.nextTick para ejecutar después de que el módulo se haya cargado completamente\r\n\tprocess.nextTick(() => {\r\n\t\tinitializeServer().catch(console.error)\r\n\t})\r\n}\r\n\r\n"],"names":[],"mappings":"sCAOA,IAAI,GAAyB,EAEtB,eAAe,IAErB,GAA+B,0BAA0B,CAArD,QAAQ,GAAG,CAAC,UAAU,GAItB,EAMH,GAAI,CAEH,WAAW,OARe,GASzB,GAAM,sBAAE,CAAoB,CAAE,CAAG,MAAA,EAAA,CAAA,CAAA,OAMjC,EAFgE,IAGhE,CAHqE,EAG5C,EAEzB,QAAQ,EAHa,CAGV,CAAC,4DACb,EAAG,IACJ,CAAE,MAAO,EAAO,CACf,QAAQ,KAAK,CAAC,mDAAoD,EACnE,CAEF,CAGgE,0BAA0B,CAArD,QAAQ,GAAG,CAAC,UAAU,EAE1D,QAAQ,QAAQ,CAAC,KAChB,IAAmB,KAAK,CAAC,QAAQ,KAAK,CACvC"}